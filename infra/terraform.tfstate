{"version":4,"terraform_version":"1.9.0","serial":18,"lineage":"9123ba81-8f63-4786-e060-0dfe4db8279b","outputs":{"ingest_lambda_url":{"value":"https://yjbud4uo4hodckwf4eceekjfiu0sutug.lambda-url.ap-southeast-2.on.aws/","type":"string"},"s3_bucket":{"value":"api-health-data-ntonthat","type":"string"}},"resources":[{"mode":"managed","type":"aws_ecr_repository","name":"ingest_repo","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"arn":"arn:aws:ecr:ap-southeast-2:110386608476:repository/lambda_ingest_repo","encryption_configuration":[{"encryption_type":"AES256","kms_key":""}],"force_delete":null,"id":"lambda_ingest_repo","image_scanning_configuration":[{"scan_on_push":false}],"image_tag_mutability":"MUTABLE","name":"lambda_ingest_repo","registry_id":"110386608476","repository_url":"110386608476.dkr.ecr.ap-southeast-2.amazonaws.com/lambda_ingest_repo","tags":{},"tags_all":{},"timeouts":null},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiZGVsZXRlIjoxMjAwMDAwMDAwMDAwfX0="}]},{"mode":"managed","type":"aws_iam_policy","name":"lambda_ingest_s3_policy","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"arn":"arn:aws:iam::110386608476:policy/lambda_ingest_s3_policy","attachment_count":1,"description":"Allow ingest lambda to put objects in S3 under landing/","id":"arn:aws:iam::110386608476:policy/lambda_ingest_s3_policy","name":"lambda_ingest_s3_policy","name_prefix":"","path":"/","policy":"{\"Statement\":[{\"Action\":[\"s3:PutObject\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:s3:::api-health-data-ntonthat/landing/*\"}],\"Version\":\"2012-10-17\"}","policy_id":"ANPARTM4N7FOK6C4GQWFR","tags":{},"tags_all":{}},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_s3_bucket.health_data_bucket"]}]},{"mode":"managed","type":"aws_iam_role","name":"lambda_ingest_role","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"arn":"arn:aws:iam::110386608476:role/lambda_ingest_role","assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","create_date":"2025-03-10T10:44:55Z","description":"","force_detach_policies":false,"id":"lambda_ingest_role","inline_policy":[],"managed_policy_arns":["arn:aws:iam::110386608476:policy/lambda_ingest_s3_policy","arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"],"max_session_duration":3600,"name":"lambda_ingest_role","name_prefix":"","path":"/","permissions_boundary":"","tags":{},"tags_all":{},"unique_id":"AROARTM4N7FONMUOUPKUI"},"sensitive_attributes":[],"private":"bnVsbA=="}]},{"mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_ingest_basic_execution","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"id":"lambda_ingest_role-20250310104457252900000001","policy_arn":"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole","role":"lambda_ingest_role"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_iam_role.lambda_ingest_role"]}]},{"mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_ingest_s3_attach","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"id":"lambda_ingest_role-20250310104458089600000002","policy_arn":"arn:aws:iam::110386608476:policy/lambda_ingest_s3_policy","role":"lambda_ingest_role"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_iam_policy.lambda_ingest_s3_policy","aws_iam_role.lambda_ingest_role","aws_s3_bucket.health_data_bucket"]}]},{"mode":"managed","type":"aws_lambda_function","name":"ingest_lambda","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"architectures":["x86_64"],"arn":"arn:aws:lambda:ap-southeast-2:110386608476:function:ingest_health_data","code_sha256":"29aa83d1c02b56f58812c97b29a67669127506df3b448944f6c49bd02c2cfb5d","code_signing_config_arn":"","dead_letter_config":[],"description":"","environment":[{"variables":{"S3_BUCKET":"api-health-data-ntonthat"}}],"ephemeral_storage":[{"size":512}],"file_system_config":[],"filename":null,"function_name":"ingest_health_data","handler":"","id":"ingest_health_data","image_config":[],"image_uri":"110386608476.dkr.ecr.ap-southeast-2.amazonaws.com/lambda_ingest_repo:latest","invoke_arn":"arn:aws:apigateway:ap-southeast-2:lambda:path/2015-03-31/functions/arn:aws:lambda:ap-southeast-2:110386608476:function:ingest_health_data/invocations","kms_key_arn":"","last_modified":"2025-03-10T11:04:41.248+0000","layers":[],"logging_config":[{"application_log_level":"","log_format":"Text","log_group":"/aws/lambda/ingest_health_data","system_log_level":""}],"memory_size":128,"package_type":"Image","publish":false,"qualified_arn":"arn:aws:lambda:ap-southeast-2:110386608476:function:ingest_health_data:$LATEST","qualified_invoke_arn":"arn:aws:apigateway:ap-southeast-2:lambda:path/2015-03-31/functions/arn:aws:lambda:ap-southeast-2:110386608476:function:ingest_health_data:$LATEST/invocations","replace_security_groups_on_destroy":null,"replacement_security_group_ids":null,"reserved_concurrent_executions":-1,"role":"arn:aws:iam::110386608476:role/lambda_ingest_role","runtime":"","s3_bucket":null,"s3_key":null,"s3_object_version":null,"signing_job_arn":"","signing_profile_version_arn":"","skip_destroy":false,"snap_start":[],"source_code_hash":"","source_code_size":0,"tags":{},"tags_all":{},"timeout":3,"timeouts":null,"tracing_config":[{"mode":"PassThrough"}],"version":"$LATEST","vpc_config":[]},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH19","dependencies":["aws_ecr_repository.ingest_repo","aws_iam_role.lambda_ingest_role","aws_s3_bucket.health_data_bucket","null_resource.build_push_ingest"]}]},{"mode":"managed","type":"aws_lambda_function_url","name":"ingest_lambda_url","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"authorization_type":"NONE","cors":[],"function_arn":"arn:aws:lambda:ap-southeast-2:110386608476:function:ingest_health_data","function_name":"ingest_health_data","function_url":"https://yjbud4uo4hodckwf4eceekjfiu0sutug.lambda-url.ap-southeast-2.on.aws/","id":"ingest_health_data","invoke_mode":"BUFFERED","qualifier":"","timeouts":null,"url_id":"yjbud4uo4hodckwf4eceekjfiu0sutug"},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==","dependencies":["aws_ecr_repository.ingest_repo","aws_iam_role.lambda_ingest_role","aws_lambda_function.ingest_lambda","aws_s3_bucket.health_data_bucket","null_resource.build_push_ingest"]}]},{"mode":"managed","type":"aws_s3_bucket","name":"health_data_bucket","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"acceleration_status":"","acl":null,"arn":"arn:aws:s3:::api-health-data-ntonthat","bucket":"api-health-data-ntonthat","bucket_domain_name":"api-health-data-ntonthat.s3.amazonaws.com","bucket_prefix":"","bucket_regional_domain_name":"api-health-data-ntonthat.s3.ap-southeast-2.amazonaws.com","cors_rule":[],"force_destroy":false,"grant":[{"id":"549df8ab0220b17c8be5925e3d728862c3523e77344f2b4e32078a6e2c4477ee","permissions":["FULL_CONTROL"],"type":"CanonicalUser","uri":""}],"hosted_zone_id":"Z1WCIGYICN2BYD","id":"api-health-data-ntonthat","lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"object_lock_enabled":false,"policy":"","region":"ap-southeast-2","replication_configuration":[],"request_payer":"BucketOwner","server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":"","sse_algorithm":"AES256"}],"bucket_key_enabled":false}]}],"tags":{},"tags_all":{},"timeouts":null,"versioning":[{"enabled":true,"mfa_delete":false}],"website":[],"website_domain":null,"website_endpoint":null},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjM2MDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19"}]},{"mode":"managed","type":"aws_s3_bucket_acl","name":"health_data_bucket","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"access_control_policy":[{"grant":[{"grantee":[{"display_name":"n.nam.tonthat","email_address":"","id":"549df8ab0220b17c8be5925e3d728862c3523e77344f2b4e32078a6e2c4477ee","type":"CanonicalUser","uri":""}],"permission":"FULL_CONTROL"}],"owner":[{"display_name":"n.nam.tonthat","id":"549df8ab0220b17c8be5925e3d728862c3523e77344f2b4e32078a6e2c4477ee"}]}],"acl":"private","bucket":"api-health-data-ntonthat","expected_bucket_owner":"","id":"api-health-data-ntonthat,private"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_s3_bucket.health_data_bucket","aws_s3_bucket_ownership_controls.health_data_bucket"]}]},{"mode":"managed","type":"aws_s3_bucket_ownership_controls","name":"health_data_bucket","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"bucket":"api-health-data-ntonthat","id":"api-health-data-ntonthat","rule":[{"object_ownership":"BucketOwnerPreferred"}]},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_s3_bucket.health_data_bucket"]}]},{"mode":"managed","type":"aws_s3_bucket_versioning","name":"health_data_bucket","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"bucket":"api-health-data-ntonthat","expected_bucket_owner":"","id":"api-health-data-ntonthat","mfa":null,"versioning_configuration":[{"mfa_delete":"","status":"Enabled"}]},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_s3_bucket.health_data_bucket"]}]},{"mode":"managed","type":"null_resource","name":"build_push_ingest","provider":"provider[\"registry.opentofu.org/hashicorp/null\"]","instances":[{"schema_version":0,"attributes":{"id":"7319999088754090641","triggers":{"code_hash":"ad36d44082f1b7cbb0baee69f032e6c35ed8948a7c3a7365648f10098e629d3c","dockerfile_hash":"5b538e7474af132f63000946055797a1d341bfd9c2f168252f41061a0f711168","pyproject_hash":"1527a64fe646664dc8cd92b0c96476a50eaecffd1fe626eb290efba3ca1f8241"}},"sensitive_attributes":[],"dependencies":["aws_ecr_repository.ingest_repo"]}]}],"check_results":null}
